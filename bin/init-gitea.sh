#!/bin/sh

curl 'http://gitea:3000/install' -H 'Content-Type: application/x-www-form-urlencoded' --data 'db_type=SQLite3&db_host=localhost%3A3306&db_user=root&db_passwd=&db_name=gitea&ssl_mode=disable&charset=utf8&db_path=%2Fdata%2Fgitea%2Fgitea.db&app_name=Gitea%3A+Git+with+a+cup+of+tea&repo_root_path=%2Fdata%2Fgit%2Frepositories&lfs_root_path=%2Fdata%2Fgit%2Flfs&run_user=git&domain=git.demo.bigking.tk&ssh_port=2222&http_port=3000&app_url=https%3A%2F%2Fgit.demo.bigking.tk&log_root_path=%2Fdata%2Fgitea%2Flog&smtp_host=&smtp_from=&smtp_user=&smtp_passwd=&enable_federated_avatar=on&enable_open_id_sign_in=on&enable_open_id_sign_up=on&default_allow_create_organization=on&default_enable_timetracking=on&no_reply_address=noreply.localhost&admin_name=&admin_passwd=&admin_confirm_passwd=&admin_email=' --compressed
gitea admin auth add-ldap  --security-protocol=unencrypted --name ldap --host ldap --port 389 --user-search-base "ou=users,dc=demo,dc=bigking,dc=tk" --user-filter "(&(uid=%s)(|(memberOf=cn=admin,ou=groups,dc=demo,dc=bigking,dc=tk)(memberOf=cn=herbivore,ou=groups,dc=demo,dc=bigking,dc=tk)))" --email-attribute mail --bind-dn cn=readonly,dc=demo,dc=bigking,dc=tk --bind-password readonly2019 --admin-filter "(memberOf=cn=admin,ou=groups,dc=demo,dc=bigking,dc=tk)"
